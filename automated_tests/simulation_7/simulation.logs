sh run_simulation.sh
-e 2024-01-30T12:18:21 -------- @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
-e 2024-01-30T12:18:21 -------- @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
-e 2024-01-30T12:18:21 -------- Simulation 7
-e 2024-01-30T12:18:21 -------- Testing: At least once delivery: message re-delivered – updating operations
-e 2024-01-30T12:18:21 -------- @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
-e 2024-01-30T12:18:21 -------- @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Cleaning up previous platform infrastructure components...
Deleting network
WARNING! This will remove all custom networks not used by at least one container.
Are you sure you want to continue? [y/N] Deleting containers
Deleting container: ca81c6a5f5bd
ca81c6a5f5bd
Deleting container: bd37c1b79c36
bd37c1b79c36
Deleting container: 2935f866e491
2935f866e491
Deleting container: 832aa84e5d62
832aa84e5d62
Deleting container: 665b773381ab
665b773381ab
Deleting container: 0e4b637940f1
0e4b637940f1
Deleting container: 03034b99f508
03034b99f508
Deleting container: 204525d78d68
204525d78d68
Deleting container: 7a5a1b61a99a
7a5a1b61a99a
Deleting container: 6d64b84c5e7e
6d64b84c5e7e
Deleting container: 50459b7fa8b4
50459b7fa8b4
Deleting container: c32c18e4cca5
c32c18e4cca5
Deleting container: daf63a3861c8
daf63a3861c8
Deleting container: cadc3582e460
cadc3582e460
Deleting container: a1d64ab0954e
a1d64ab0954e
Deleting container: 2d2d14d04d37
2d2d14d04d37
Deleting container: 3aab9df08a95
3aab9df08a95
Deleting volumes
Deleting volume: 2b199a0ea9f706efa1b3939cb6a9321df410ac17ccec0270e819d3a73f68f980
2b199a0ea9f706efa1b3939cb6a9321df410ac17ccec0270e819d3a73f68f980
Deleting volume: 94dbc09819fe7f4a33fef07535e78ac1607c3328e50697e85a019d1b639b7057
94dbc09819fe7f4a33fef07535e78ac1607c3328e50697e85a019d1b639b7057
Deleting volume: bdb8067b53368223d369c3a2d02ff1598a7468b1bb9d08fc2fe32c26577b2842
bdb8067b53368223d369c3a2d02ff1598a7468b1bb9d08fc2fe32c26577b2842
Keeping volume: distributed-anonymization_elasticsearch-data
Keeping volume: distributed-anonymization_grafana-data
Deleting volume: simulation_7_cassandra_data
simulation_7_cassandra_data
Deleting volume: simulation_7_elasticsearch-data
simulation_7_elasticsearch-data
Deleting volume: simulation_7_grafana-data
simulation_7_grafana-data
Deleting volume: simulation_7_node-modules
simulation_7_node-modules
Deleting volume: simulation_7_postgres-data
simulation_7_postgres-data
Deleting volume: simulation_7_redis_data
simulation_7_redis_data
Deleting volume: simulation_7_redis_insight
simulation_7_redis_insight
Deleting Spark checkpoint
OK: Finished clean up
-e 2024-01-30T12:18:30 -------- Deploying mandatory infrastructure components...
[+] Building 2.4s (73/73) FINISHED
 => [simulation_7-eureka-server internal] load build definition from Dockerfile                                                                                                                            0.0s
 => => transferring dockerfile: 32B                                                                                                                                                                        0.0s
 => [simulation_7-importing-dashboard internal] load build definition from Dockerfile                                                                                                                      0.0s
 => => transferring dockerfile: 32B                                                                                                                                                                        0.0s
 => [simulation_7-blueprint-service internal] load build definition from Dockerfile                                                                                                                        0.0s
 => => transferring dockerfile: 32B                                                                                                                                                                        0.0s
 => [simulation_7-tasks-processing-service internal] load build definition from Dockerfile                                                                                                                 0.0s
 => => transferring dockerfile: 32B                                                                                                                                                                        0.0s
 => [simulation_7-database-restoration-service internal] load build definition from Dockerfile                                                                                                             0.0s
 => => transferring dockerfile: 32B                                                                                                                                                                        0.0s
 => [simulation_7-metadata-extraction-service internal] load build definition from Dockerfile                                                                                                              0.0s
 => => transferring dockerfile: 32B                                                                                                                                                                        0.0s
 => [simulation_7-api-gateway internal] load build definition from Dockerfile                                                                                                                              0.0s
 => => transferring dockerfile: 32B                                                                                                                                                                        0.0s
 => [simulation_7-eureka-server internal] load .dockerignore                                                                                                                                               0.0s
 => => transferring context: 2B                                                                                                                                                                            0.0s
 => [simulation_7-importing-dashboard internal] load .dockerignore                                                                                                                                         0.0s
 => => transferring context: 2B                                                                                                                                                                            0.0s
 => [simulation_7-blueprint-service internal] load .dockerignore                                                                                                                                           0.0s
 => => transferring context: 2B                                                                                                                                                                            0.0s
 => [simulation_7-tasks-processing-service internal] load .dockerignore                                                                                                                                    0.0s
 => => transferring context: 2B                                                                                                                                                                            0.0s
 => [simulation_7-database-restoration-service internal] load .dockerignore                                                                                                                                0.0s
 => => transferring context: 2B                                                                                                                                                                            0.0s
 => [simulation_7-metadata-extraction-service internal] load .dockerignore                                                                                                                                 0.0s
 => => transferring context: 2B                                                                                                                                                                            0.0s
 => [simulation_7-api-gateway internal] load .dockerignore                                                                                                                                                 0.0s
 => => transferring context: 2B                                                                                                                                                                            0.0s
 => [simulation_7-api-gateway internal] load metadata for docker.io/library/openjdk:17-jdk-slim                                                                                                            0.0s
 => [simulation_7-eureka-server internal] load metadata for docker.io/library/maven:3.8.4-openjdk-17-slim                                                                                                  0.8s
 => [simulation_7-importing-dashboard internal] load metadata for docker.io/library/nginx:alpine                                                                                                           0.7s
 => [simulation_7-importing-dashboard internal] load metadata for docker.io/library/node:latest                                                                                                            0.7s
 => [simulation_7-tasks-processing-service internal] load metadata for docker.io/library/sapmachine:17.0.10                                                                                                0.7s
 => [simulation_7-eureka-server stage-1 1/3] FROM docker.io/library/openjdk:17-jdk-slim                                                                                                                    0.0s
 => [simulation_7-eureka-server build 1/8] FROM docker.io/library/maven:3.8.4-openjdk-17-slim@sha256:150deb7b386bad685dcf0c781b9b9023a25896087b637c069a50c8019cab86f8                                      0.0s
 => [simulation_7-api-gateway internal] load build context                                                                                                                                                 0.0s
 => => transferring context: 878B                                                                                                                                                                          0.0s
 => [simulation_7-database-restoration-service internal] load build context                                                                                                                                0.0s
 => => transferring context: 15.97kB                                                                                                                                                                       0.0s
 => [simulation_7-eureka-server internal] load build context                                                                                                                                               0.0s
 => => transferring context: 891B                                                                                                                                                                          0.0s
 => [simulation_7-blueprint-service internal] load build context                                                                                                                                           0.0s
 => => transferring context: 7.04kB                                                                                                                                                                        0.0s
 => [simulation_7-metadata-extraction-service internal] load build context                                                                                                                                 0.0s
 => => transferring context: 7.57kB                                                                                                                                                                        0.0s
 => [simulation_7-tasks-processing-service 1/3] FROM docker.io/library/sapmachine:17.0.10@sha256:f7a0d31d8a94c4342bee70cd0e658b0acac258fd8e8fa79483bf2adfaf9fdad1                                          0.0s
 => [simulation_7-tasks-processing-service internal] load build context                                                                                                                                    0.0s
 => => transferring context: 9.28kB                                                                                                                                                                        0.0s
 => CACHED [simulation_7-database-restoration-service build 2/8] WORKDIR /app                                                                                                                              0.0s
 => CACHED [simulation_7-api-gateway build 3/6] COPY pom.xml .                                                                                                                                             0.0s
 => CACHED [simulation_7-api-gateway build 4/6] RUN mvn dependency:go-offline                                                                                                                              0.0s
 => CACHED [simulation_7-api-gateway build 5/6] COPY src /app/src                                                                                                                                          0.0s
 => CACHED [simulation_7-api-gateway build 6/6] RUN mvn clean package -DskipTests -X                                                                                                                       0.0s
 => CACHED [simulation_7-api-gateway stage-1 2/2] COPY --from=build /app/target/*.jar app.jar                                                                                                              0.0s
 => [simulation_7-importing-dashboard] exporting to image                                                                                                                                                  0.0s
 => => exporting layers                                                                                                                                                                                    0.0s
 => => writing image sha256:2fc17c627c2b5b7e58ebc5b1350aa96f858270b51323f44d46796df548c7815c                                                                                                               0.0s
 => => naming to docker.io/library/simulation_7-api-gateway                                                                                                                                                0.0s
 => => writing image sha256:a086b27f3a8374a0697a8fa6f1549a58fcce0684d3536e16fbbb067b6a54e696                                                                                                               0.0s
 => => writing image sha256:84ef8b2435378cb620d33c35af4587583a681d3c9ae610ad02b9a58d579e827f                                                                                                               0.0s
 => => naming to docker.io/library/simulation_7-tasks-processing-service                                                                                                                                   0.0s
 => => naming to docker.io/library/simulation_7-blueprint-service                                                                                                                                          0.0s
 => => writing image sha256:9e7dd23d955dd622a65e38739a67fd498f93c2daff48130d842db0ffaf850837                                                                                                               0.0s
 => => naming to docker.io/library/simulation_7-eureka-server                                                                                                                                              0.0s
 => => writing image sha256:836543c09cba5db4170c11d61a8459df4a0469becac306a3dc1ee545d33e1a56                                                                                                               0.0s
 => => naming to docker.io/library/simulation_7-metadata-extraction-service                                                                                                                                0.0s
 => => writing image sha256:2c12dd9d53233d4912aa9dbedda74605522bbef67e1d2df508bf291a001def41                                                                                                               0.0s
 => => naming to docker.io/library/simulation_7-database-restoration-service                                                                                                                               0.0s
 => => writing image sha256:7399e3ae4698bc84bf948d801f65fd540f58d0f298e6745a5e8fec30878e6695                                                                                                               0.0s
 => => naming to docker.io/library/simulation_7-importing-dashboard                                                                                                                                        0.0s
 => CACHED [simulation_7-blueprint-service build 3/8] COPY shared_libraries/*.jar /usr/share/maven/ref/                                                                                                    0.0s
 => CACHED [simulation_7-blueprint-service build 4/8] RUN mvn install:install-file -Dfile=/usr/share/maven/ref/shared-logging-library-1.0-SNAPSHOT.jar -DgroupId=com.wenox.anonymization -DartifactId=sha  0.0s
 => CACHED [simulation_7-blueprint-service build 5/8] COPY pom.xml .                                                                                                                                       0.0s
 => CACHED [simulation_7-blueprint-service build 6/8] RUN mvn dependency:go-offline                                                                                                                        0.0s
 => CACHED [simulation_7-blueprint-service build 7/8] COPY src /app/src                                                                                                                                    0.0s
 => CACHED [simulation_7-blueprint-service build 8/8] RUN mvn clean package -DskipTests                                                                                                                    0.0s
 => CACHED [simulation_7-blueprint-service stage-1 2/2] COPY --from=build /app/target/*.jar app.jar                                                                                                        0.0s
 => CACHED [simulation_7-eureka-server build 3/6] COPY pom.xml .                                                                                                                                           0.0s
 => CACHED [simulation_7-eureka-server build 4/6] RUN mvn dependency:go-offline                                                                                                                            0.0s
 => CACHED [simulation_7-eureka-server build 5/6] COPY src /app/src                                                                                                                                        0.0s
 => CACHED [simulation_7-eureka-server build 6/6] RUN mvn clean package -DskipTests -X                                                                                                                     0.0s
 => CACHED [simulation_7-eureka-server stage-1 2/2] COPY --from=build /app/target/*.jar app.jar                                                                                                            0.0s
 => CACHED [simulation_7-tasks-processing-service 2/3] WORKDIR /app                                                                                                                                        0.0s
 => CACHED [simulation_7-tasks-processing-service 3/3] COPY target /app                                                                                                                                    0.0s
 => [simulation_7-importing-dashboard build 1/6] FROM docker.io/library/node:latest@sha256:0ded28778059262bd3c066b609186e5b6c89550a9362dce4309ad67c95af0d77                                                0.0s
 => [simulation_7-importing-dashboard internal] load build context                                                                                                                                         1.1s
 => => transferring context: 3.84MB                                                                                                                                                                        1.0s
 => [simulation_7-importing-dashboard stage-1 1/2] FROM docker.io/library/nginx:alpine@sha256:5b7ff23e6861b908f034b82d2cf77a295488e0d13271e5438ac211fcf9ed9b25                                             0.0s
 => => resolve docker.io/library/nginx:alpine@sha256:5b7ff23e6861b908f034b82d2cf77a295488e0d13271e5438ac211fcf9ed9b25                                                                                      0.0s
 => CACHED [simulation_7-metadata-extraction-service build 3/8] COPY shared_libraries/*.jar /usr/share/maven/ref/                                                                                          0.0s
 => CACHED [simulation_7-metadata-extraction-service build 4/8] RUN mvn install:install-file -Dfile=/usr/share/maven/ref/shared-logging-library-1.0-SNAPSHOT.jar -DgroupId=com.wenox.anonymization -Darti  0.0s
 => CACHED [simulation_7-metadata-extraction-service build 5/8] COPY pom.xml .                                                                                                                             0.0s
 => CACHED [simulation_7-metadata-extraction-service build 6/8] RUN mvn dependency:go-offline                                                                                                              0.0s
 => CACHED [simulation_7-metadata-extraction-service build 7/8] COPY src /app/src                                                                                                                          0.0s
 => CACHED [simulation_7-metadata-extraction-service build 8/8] RUN mvn clean package -DskipTests                                                                                                          0.0s
 => CACHED [simulation_7-metadata-extraction-service stage-1 2/2] COPY --from=build /app/target/*.jar app.jar                                                                                              0.0s
 => CACHED [simulation_7-database-restoration-service stage-1 2/3] RUN apt-get update && apt-get install -y postgresql-client && rm -rf /var/lib/apt/lists/*                                               0.0s
 => CACHED [simulation_7-database-restoration-service build 3/8] COPY shared_libraries/*.jar /usr/share/maven/ref/                                                                                         0.0s
 => CACHED [simulation_7-database-restoration-service build 4/8] RUN mvn install:install-file -Dfile=/usr/share/maven/ref/shared-logging-library-1.0-SNAPSHOT.jar -DgroupId=com.wenox.anonymization -Dart  0.0s
 => CACHED [simulation_7-database-restoration-service build 5/8] COPY pom.xml .                                                                                                                            0.0s
 => CACHED [simulation_7-database-restoration-service build 6/8] RUN mvn dependency:go-offline                                                                                                             0.0s
 => CACHED [simulation_7-database-restoration-service build 7/8] COPY src /app/src                                                                                                                         0.0s
 => CACHED [simulation_7-database-restoration-service build 8/8] RUN mvn clean package -DskipTests                                                                                                         0.0s
 => CACHED [simulation_7-database-restoration-service stage-1 3/3] COPY --from=build /app/target/*.jar app.jar                                                                                             0.0s
 => CACHED [simulation_7-importing-dashboard build 2/6] WORKDIR /app                                                                                                                                       0.0s
 => CACHED [simulation_7-importing-dashboard build 3/6] COPY package.json package-lock.json ./                                                                                                             0.0s
 => CACHED [simulation_7-importing-dashboard build 4/6] RUN npm install                                                                                                                                    0.0s
 => CACHED [simulation_7-importing-dashboard build 5/6] COPY . .                                                                                                                                           0.0s
 => CACHED [simulation_7-importing-dashboard build 6/6] RUN npm run build                                                                                                                                  0.0s
 => CACHED [simulation_7-importing-dashboard stage-1 2/2] COPY --from=build /app/build /usr/share/nginx/html                                                                                               0.0s
[+] Running 31/31
 ⠿ Volume "simulation_7_redis_data"                       Created                                                                                                                                          0.0s
 ⠿ Volume "simulation_7_redis_insight"                    Created                                                                                                                                          0.0s
 ⠿ Volume "simulation_7_elasticsearch-data"               Created                                                                                                                                          0.0s
 ⠿ Volume "simulation_7_postgres-data"                    Created                                                                                                                                          0.0s
 ⠿ Volume "simulation_7_grafana-data"                     Created                                                                                                                                          0.0s
 ⠿ Volume "simulation_7_cassandra_data"                   Created                                                                                                                                          0.0s
 ⠿ Volume "simulation_7_node-modules"                     Created                                                                                                                                          0.0s
 ⠿ Container simulation_7-metadata-extraction-service-1   Started                                                                                                                                          2.4s
 ⠿ Container simulation_7-api-gateway-1                   Started                                                                                                                                          2.5s
 ⠿ Container simulation_7-database-restoration-service-1  Started                                                                                                                                          2.0s
 ⠿ Container grafana                                      Started                                                                                                                                          2.0s
 ⠿ Container simulation_7-blueprint-service-1             Started                                                                                                                                          0.5s
 ⠿ Container elasticsearch                                Started                                                                                                                                          0.6s
 ⠿ Container simulation_7-spark-master-1                  Started                                                                                                                                          2.4s
 ⠿ Container simulation_7-importing-dashboard-1           Started                                                                                                                                          1.4s
 ⠿ Container simulation_7-postgres-1                      Started                                                                                                                                          1.8s
 ⠿ Container mongodb                                      Started                                                                                                                                          2.1s
 ⠿ Container simulation_7-eureka-server-1                 Started                                                                                                                                          1.0s
 ⠿ Container prometheus                                   Started                                                                                                                                          1.7s
 ⠿ Container cassandra                                    Started                                                                                                                                          1.9s
 ⠿ Container redis                                        Started                                                                                                                                          2.1s
 ⠿ Container redisinsight                                 Started                                                                                                                                          2.4s
 ⠿ Container zookeeper                                    Started                                                                                                                                          1.2s
 ⠿ Container simulation_7-spark-worker-1                  Started                                                                                                                                          2.9s
 ⠿ Container simulation_7-tasks-processing-service-1      Started                                                                                                                                          2.8s
 ⠿ Container logstash                                     Started                                                                                                                                          2.6s
 ⠿ Container kibana                                       Started                                                                                                                                          2.4s
 ⠿ Container cassandra-init                               Started                                                                                                                                          2.6s
 ⠿ Container kafka                                        Started                                                                                                                                          2.6s
 ⠿ Container kafka-ui                                     Started                                                                                                                                          3.1s
 ⠿ Container simulation_7-worksheet-service-1             Started                                                                                                                                          3.1s
-e 2024-01-30T12:18:37 -------- Waiting 120 seconds for infrastructure to settle...
-e 2024-01-30T12:20:37 -------- @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
-e 2024-01-30T12:20:37 -------- @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
-e 2024-01-30T12:20:37 -------- Infrastructure ready – executing simulation 7
-e 2024-01-30T12:20:37 -------- Testing: At least once delivery: message re-delivered – updating operations
-e 2024-01-30T12:20:37 -------- @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
-e 2024-01-30T12:20:37 -------- @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
-e 2024-01-30T12:20:37 -------- Starting importing process...
-e 2024-01-30T12:20:39 -------- OK: Importing process started successfully --- blueprint ID: 83a50e23-ee41-4e01-8fb2-ad4df6cce7b7
-e 2024-01-30T12:20:39 -------- Waiting 15 seconds: letting the importing process complete
-e 2024-01-30T12:20:54 -------- Verifying importing process is successful...
-e 2024-01-30T12:20:54 -------- OK: Importing process completed successfully with status: METADATA_EXTRACTION_SUCCESS
-e 2024-01-30T12:20:54 -------- Initialising a new worksheet for blueprint_id: 83a50e23-ee41-4e01-8fb2-ad4df6cce7b7
-e 2024-01-30T12:20:55 -------- OK: Successfully initialised new worksheet with ID: 64f8e308-3bf9-4ad2-a18f-f0cda1a90989
-e 2024-01-30T12:20:55 -------- Adding suppression operation to worksheet...
-e 2024-01-30T12:20:55 -------- OK: Successfully added suppression operation to a worksheet
-e 2024-01-30T12:20:55 -------- Waiting 15 seconds – letting the service crash...
-e 2024-01-30T12:21:10 -------- Stopping Docker container spanning the worksheet-service...
[+] Running 1/0
 ⠿ Container simulation_7-worksheet-service-1  Stopped                                                                                                                                                     0.0s
-e 2024-01-30T12:21:10 -------- OK: Docker container stopped
-e 2024-01-30T12:21:10 -------- Starting Docker container spanning the worksheet-service...
[+] Running 2/0
 ⠿ Container cassandra       Running                                                                                                                                                                       0.0s
 ⠿ Container cassandra-init  Created                                                                                                                                                                       0.0s
[+] Running 1/1
 ⠿ Container cassandra-init  Started                                                                                                                                                                       0.3s
1cba64d6e389dbb1136cd67b929e35f531fabc2b6175f1cb971a95617b66b0e8
-e 2024-01-30T12:21:11 -------- OK: Docker container started: worksheet-service restarted
-e 2024-01-30T12:21:11 -------- Verifying that anonymisation operation converged to the expected state after the message was re-delivered
-e 2024-01-30T12:21:11 -------- Received HTTP status 500. Retrying in 5 seconds.. (Attempt 1/60)
-e 2024-01-30T12:21:16 -------- Received HTTP status 500. Retrying in 5 seconds.. (Attempt 2/60)
-e 2024-01-30T12:21:21 -------- Received HTTP status 500. Retrying in 5 seconds.. (Attempt 3/60)
-e 2024-01-30T12:21:27 -------- Anonymisation operation still not successful. Retrying in 5 second... (Attempt 4/60)
-e 2024-01-30T12:21:32 -------- Anonymisation operation still not successful. Retrying in 5 second... (Attempt 5/60)
-e 2024-01-30T12:21:37 -------- Anonymisation operation still not successful. Retrying in 5 second... (Attempt 6/60)
-e 2024-01-30T12:21:42 -------- Anonymisation operation still not successful. Retrying in 5 second... (Attempt 7/60)
-e 2024-01-30T12:21:47 -------- OK: Anonymisation operation converged to a valid state after message was re-delivered – task processed successfully
-e 2024-01-30T12:21:47 -------- OK: Simulation 7 finished successfully
-e 2024-01-30T12:21:47 -------- Tested: At least once delivery: message re-delivered – updating operations